{"pageProps":{"posts":[{"slug":"2025-08-09-day0-gpt-oss","frontmatter":{"title":"Day 0 Support of Serving OpenAI GPT-OSS on Hopper and Blackwell GPUs with Free Online Playground","author":"Eigen AI Team","date":"Aug 09 2025","previewImg":"/images/blog/2025-08-09-day0-gpt-oss/arch.png"},"content":"\nIn this blog, we're excited to achieve day 0 support for the serving of OpenAI’s GPT-OSS-120B and GPT-OSS-20B on Hopper/Blackwell GPUs in collaboration with the SGLang team. We also introduce a free online playground featuring both web and API access to the GPT-OSS-120B model ([chat.eigenai.com](https://chat.eigenai.com)) in partnership with Yotta Labs. Major performance optimizations are already in the pipeline, and we expect to offer even faster, smarter, and more scalable services in the days ahead.\n\n---\n\n## Introduction of GPT-OSS Architecture\n\nGPT-OSS is a newly released open-source large language model (LLM) from OpenAI designed for the efficient deployment of reasoning tasks. OpenAI open-sourced two versions of GPT-OSS: [GPT-OSS-120B and GPT-OSS-20B](https://huggingface.co/openai/gpt-oss-20b/blob/main/README.md).\n\n- **GPT-OSS-120B**: for production, general purpose, high reasoning use cases (117B parameters)  \n- **GPT-OSS-20B**: for lower latency, and local or specialized use cases (21B parameters)  \n\nFigure 1 illustrates the architectural details.\n\n![GPT-OSS Architecture](/images/blog/2025-08-09-day0-gpt-oss/arch.png)\n\n**Figure 1.** Illustration of GPT-OSS architecture. GptOssMoE layers and GptOssAttn (sinked sliding window grouped-query attention) layers.\n<br><br>\n\n---\n\n### GptOssAttn\n\nGPT-OSS introduces a novel attention mechanism that interleaves sliding window attention and full attention. Specifically, odd-numbered layers use sliding window grouped-query attention (GQA) with a window size of 128, and even layers use full attention. All attention layers include bias terms in the linear projection layers (queries, keys, values, and output). A distinctive sinked attention mechanism is applied: for each attention head, a learnable scalar parameter (referred to as the sink) is appended as the last column of the attention score matrix **S** prior to softmax. After softmax computation, the sink column is detached, yielding a standard square attention matrix **A**. This operation is mathematically equivalent to modifying the softmax denominator with an additional exponential term.\n\n<img src=\"/images/blog/2025-08-09-day0-gpt-oss/eqn1.png\"\n     alt=\"Attention Sink Mechanism\"\n     style=\"width:200px; height:auto;\">\n\n**Why Attention Sinks?** Adding just one learnable parameter per attention head enables the model to \"pay no attention to any tokens\" when needed. The presence of a sink draws attention away from other tokens, limiting the spread of information (and noise) and resulting in more stable embeddings, which is especially critical for the stability of sliding window attention. OpenAI's model card for GPT-OSS-20B explains the attention sink mechanism, directly connecting the design to our research, i.e., StreamingLLM [1] and SpAtten [2].\n\n![StreamingLLM Figure](/images/blog/2025-08-09-day0-gpt-oss/streamingllm.png)\n**Figure 2.** In MIT-HAN-Lab's StreamingLLM [1], the first few \"sink\" tokens are kept in the cache, which has unlocked infinite-length generation by respecting the model's existing attention patterns.\n\nThe approach in StreamingLLM learns a full token embedding that can interact differently with each query (see Figure 2), while OpenAI instead adds a single learnable value that acts as a universal escape valve. Both successfully solve the fundamental problem: giving attention somewhere to go when it has nothing meaningful to attend to.\n\n![SpAtten Figure](/images/blog/2025-08-09-day0-gpt-oss/spatten.png)\n**Figure 3.** Initial tokens are always kept in SpAtten [2].\n<br><br>\n\nA similar phenomenon has been observed in BERT, where \"a surprisingly large amount of attention focuses on the delimiter token [SEP] and periods. Our work SpAtten [2] in 2021, which pioneered attention score-based KV Cache pruning and quantization of attention, also found that GPT-2 preserved its initial token, as shown in Figure 3.\n\nThe attention sink mechanism discovered has since been adopted across the industry, appearing in production systems like OpenAI's models and inspiring new research directions in quantization and model optimization.\n<br><br>\n\n---\n\n### GptOssMoE\n\nFor Mixture-of-Experts (MoE) layers, each token selects the top-4 experts based on router scores from 128 (for 120B) or 32 (for 20B) experts. The expert adopts **SwigLU** activation, and three linear layers, including gate, up, and down projections, all have bias terms enabled. The gate branch employs a **Swish** activation function with β = 1.702, and the up branch is added by 1 and multiplied with the gate output. To ensure numerical stability:\n\n- The gate pre-activation is clipped at a maximum value of 7 before applying Swish.  \n- The up branch is clipped to the range [−7, 7] before the +1 shift.\n\nThe MoE computation is summarized as:\n\n<img src=\"/images/blog/2025-08-09-day0-gpt-oss/eqn2.png\" alt=\"MoE Computation\" style=\"width:400px; height:auto;\">\n\nThe outputs of the top-k selected experts will be summed up with the softmax-normalized router weights.\n\n<img src=\"/images/blog/2025-08-09-day0-gpt-oss/eqn3.png\" alt=\"MoE Output\" style=\"width:300px; height:auto;\">\n\n---\n\n## Try Local GPT-OSS Serving on Hopper/Blackwell GPUs\n\nPlease follow the instructions [here](https://github.com/sgl-project/sglang/issues/8833) to set up a ready-to-use container to try out GPT-OSS serving.\n<br><br>\n\n---\n\n## Introducing the Eigen AI Playground\n\nWe’re thrilled to announce the launch of the **Eigen AI Playground**, built in partnership with Yotta Labs – a free online platform where anyone can experience the power of OpenAI’s GPT-OSS-120B model right in their browser: [chat.eigenai.com](https://chat.eigenai.com). This platform is well optimized for performance and includes comprehensive, reproducible deployment guides, enabling users to integrate these advancements into their projects with ease. This initiative reflects our broader vision to make the transformative power of AI accessible globally, fostering innovation across industries and communities.\n\n**Explore now on the web:**\n\nThe web interface offers an intuitive and smooth chat experience with GPT-OSS-120B:  \n\n<img src=\"/images/blog/2025-08-09-day0-gpt-oss/chatbot.png\" alt=\"Web Playground\" style=\"width:100%\">\n\n**Integrate via API:**\n\nFor developers or advanced users, we also provide a simple API that allows you to integrate GPT-OSS-120B directly into your applications for free.\n\n```python\n# First install: pip install openai\n\nimport openai\n\nclient = openai.OpenAI(\n    api_key=\"xxx\",\n    base_url=\"https://gateway.eigenai.com/inference/public/v1\"\n)\n\nresponse = client.chat.completions.create(\n    model=\"OpenAI/GPT-OSS-120B\",\n    messages=[\n        {\"role\": \"assistant\", \"content\": \"what can i help you?\"},\n        {\"role\": \"user\", \"content\": \"test\"},\n    ],\n    temperature=0.6,\n    max_tokens=8192,\n    stream=False,\n)\n\n# Print the completion result\nprint(response.choices[0].message.content)\n```\n<br><br>\n\n---\n## Acknowledgments\n\nWe would like to express our heartfelt gratitude to the following teams and collaborators:\n\n- **Eigen AI Team & Community** – Jinglei Cheng, Jiaqi Gu, Yipin Guo, Di Jin, Yilian Uill Liu, Shuqing Luo, Zilin Shen, Ryan Wang, Wei-Chen Wang, Genghan Zhang, and many others.  \n- [SGLang Community](https://github.com/sgl-project/sglang)  \n- [Yotta Labs](https://www.yottalabs.ai/)  \n- [Innomatrix](https://innomatrix.ai/)  \n<br><br>\n\n---\n\n## Further Reading\n\n- [At Eigen AI, we’re on a mission to make sure the AI revolution doesn’t leave anyone behind. | Eigen AI](https://x.com/Eigen_AI_Labs/status/1952931721655292056)  \n- [SGLang GitHub Repository](https://github.com/sgl-project/sglang)  \n- [EigenAI Labs Huggingface Repository with GPT-OSS BF16 Checkpoints](https://huggingface.co/eigen-ai-labs/gpt-oss-120b-bf16)  \n- [How Attention Sinks Keep Language Models Stable](https://hanlab.mit.edu/blog/streamingllm)  \n- [OpenAI GPT-OSS model card](https://cdn.openai.com/pdf/419b6906-9da6-406c-a19d-1bb078ac7637/oai_gpt-oss_model_card.pdf)  \n<br><br>\n\n---\n\n## References\n\n[1] Xiao, G., Tian, Y., Chen, B., Han, S., & Lewis, M., “Efficient Streaming Language Models with Attention Sinks,” ICLR 2024.  \n[2] Wang, H., Zhang, Z., & Han, S., “SpAtten: Efficient Sparse Attention Architecture with Cascade Token and Head Pruning,” HPCA 2021.\n<br><br>\n","date":1754697600000},{"slug":"2025-07-17-mtp","frontmatter":{"title":"Accelerating SGLang with Multiple Token Prediction","author":"Eigen AI and SGLang Teams","date":"Jul 17 2025","previewImg":"/images/blog/2025-07-17-mtp/flowchart_hr_v3.png","url":"https://lmsys.org/blog/2025-07-17-mtp/"},"content":"\nEigen AI collaborates with SGLang to support smooth combination of these advanced features: Multiple Token Prediction (MTP), Large-Scale Expert Parallelism (EP), and Prefill-Decode disaggregation.\n","date":1752710400000},{"slug":"2025-05-28-workforceagent-r1","frontmatter":{"title":"WorkForceAgent-R1: Incentivizing Reasoning Capability in LLM-based Web Agents via Reinforcement Learning","author":"Eigen AI Team","date":"May 28 2025","previewImg":"/images/blog/2025-05-28-workforceagent-r1/workforceagent_r1_example.png","url":"https://arxiv.org/abs/2505.22942"},"content":"\nEigen AI introduces WorkForceAgent-R1, an LLM-based web agent trained using a rule-based R1-style RL framework designed to enhance single-step reasoning and planning for business-oriented web navigation.\n","date":1748390400000}]},"__N_SSG":true}